% 加载地下水水位数据文件
% 文件格式：x坐标, y坐标, 水位高程
A = load('normalfault.txt');

% 提取数据列
x = A(:,1);  % 测点x坐标
y = A(:,2);  % 测点y坐标
z = A(:,3);  % 地下水位高程值

% 绘制测点位置散点图
plot(x, y, '+');
hold on;  % 保持图形，以便添加更多元素

% 创建水位高程标签文本，保留3位有效数字
labels = num2str(z, 3);
% 在每个测点旁边添加水位高程标签
text(x+1, y, labels);

% 创建用于插值的规则网格，用于生成连续的水位等高线
% x方向网格范围
x1 = floor(min(x)):0.25:ceil(max(x));
% y方向网格范围
y1 = floor(min(y)):0.25:ceil(max(y));
% 生成网格坐标矩阵
[x2, y2] = meshgrid(x1, y1);

% 使用双调和样条插值方法将离散水位数据插值到规则网格上
z2 = griddata(x, y, z, x2, y2, 'v4');

% 绘制地下水水位等高线图，50条等高线
contour(x2, y2, z2, 50);
hold off; 
close;  % 关闭当前图形窗口

% 定义特定的水位等高线值范围（单位：米）
% 从-30米到25米，每5米一条等高线
v = -30:5:25;

% 创建带数值标注的等高线图
figure
[c, h] = contour(x2, y2, z2, v);
clabel(c, h);  % 自动标注等高线数值
close;

% 创建手动标注的等高线图
figure
[c, h] = contour(x2, y2, z2, v);
clabel(c, h, 'manual');  % 手动选择标注位置
close;

% 绘制地下水流动方向图（水位梯度场）
figure
contour(x2, y2, z2, v);  % 先绘制等高线
hold on;
% 计算水位梯度场（地下水流向垂直于等高线）
[dx, dy] = gradient(z2, 1, 1);  % 计算x,y方向的水力梯度
quiver(x2, y2, dx, dy);  % 绘制箭头表示水流方向
close;

% 创建三维地下水水位可视化
figure
% 绘制填充等高线图
contourf(x2, y2, z2, v);
% 绘制伪彩色图显示水位分布
pcolor(x2, y2, z2);
% 绘制三维网格曲面
mesh(x2, y2, z2);
% 设置视角
view(-30, 40);
close;

% 创建最终的三维地下水水位曲面图
surf(x2, y2, z2);
% 可选：surfc(x2, y2, z2);  % 带等高线的三维曲面

% 增强可视化效果：
shading interp;  % 插值着色，使表面平滑
light;           % 添加光照效果
axis off;        % 隐藏坐标轴，专注于地形显示

% 说明：
% 该代码用于可视化地下水水位分布特征：
% 1. 散点图显示测点位置和水位值
% 2. 等高线图显示水位等值线分布
% 3. 梯度场箭头显示地下水流向（从高水位流向低水位）
% 4. 三维曲面直观展示地下水水位地形
% 负值表示低于基准面的水位，正值表示高于基准面的水位
